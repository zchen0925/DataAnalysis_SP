mean(subset(ng_SPR_SC_S, Seg == 'seg02')$RT),
mean(subset(ng_SPR_SC_S, Seg == 'seg03')$RT),
mean(subset(ng_SPR_SC_S, Seg == 'seg04')$RT),
mean(subset(ng_SPR_SC_S, Seg == 'seg05')$RT),
mean(subset(ng_SPR_SC_S, Seg == 'seg06')$RT),
mean(subset(ng_SPR_SC_S, Seg == 'seg07')$RT),
mean(subset(ng_SPR_SC_S, Seg == 'seg08')$RT),
mean(subset(ng_SPR_SC_S, Seg == 'seg09')$RT),
mean(subset(ng_SPR_SC_S, Seg == 'seg10')$RT)
),
se <- c(
std.error(subset(gp_SPR_SC_S, Seg == 'seg01')$RT),
std.error(subset(gp_SPR_SC_S, Seg == 'seg02')$RT),
std.error(subset(gp_SPR_SC_S, Seg == 'seg03')$RT),
NA,
std.error(subset(gp_SPR_SC_S, Seg == 'seg04')$RT),
std.error(subset(gp_SPR_SC_S, Seg == 'seg05')$RT),
std.error(subset(gp_SPR_SC_S, Seg == 'seg06')$RT),
std.error(subset(gp_SPR_SC_S, Seg == 'seg07')$RT),
std.error(subset(gp_SPR_SC_S, Seg == 'seg08')$RT),
std.error(subset(gp_SPR_SC_S, Seg == 'seg09')$RT),
std.error(subset(ng_SPR_SC_S, Seg == 'seg01')$RT),
std.error(subset(ng_SPR_SC_S, Seg == 'seg02')$RT),
std.error(subset(ng_SPR_SC_S, Seg == 'seg03')$RT),
std.error(subset(ng_SPR_SC_S, Seg == 'seg04')$RT),
std.error(subset(ng_SPR_SC_S, Seg == 'seg05')$RT),
std.error(subset(ng_SPR_SC_S, Seg == 'seg06')$RT),
std.error(subset(ng_SPR_SC_S, Seg == 'seg07')$RT),
std.error(subset(ng_SPR_SC_S, Seg == 'seg08')$RT),
std.error(subset(ng_SPR_SC_S, Seg == 'seg09')$RT),
std.error(subset(ng_SPR_SC_S, Seg == 'seg10')$RT)
)
)
colnames(df_gp_SPR_SC_SegRT)<-(c("s_label", "s_words","CONDITION","avg","se"))
df_gp_SPR_SegRT <- data.frame(rbind(df_gp_SPR_CB_SegRT,df_gp_SPR_SC_SegRT))
df_gp_SPR_SegRT$Group <- c(rep("Blind",20),rep("Sighted",20))
df_gp_SPR_CB_SegRT$s_words <- factor(df_gp_SPR_CB_SegRT$s_words, levels = c("While", "the boy","hunted","the fireflies", "the colorful","and small","butterflies", "flew", "across", "the clearing"))
df_gp_SPR_SC_SegRT$s_words <- factor(df_gp_SPR_SC_SegRT$s_words, levels = c("While", "the boy","hunted","the fireflies", "the colorful","and small","butterflies", "flew", "across", "the clearing"))
df_gp_SPR_SegRT$s_words <- factor(df_gp_SPR_SegRT$s_words, levels = c("While", "the boy","hunted","the fireflies", "the colorful","and small","butterflies", "flew", "across", "the clearing"))
ggplot(data = df_gp_SegRT, aes(x = s_words, y=avg, group = interaction(CONDITION, Group), colour = CONDITION, linetype = Group, ymin=avg-se, ymax=avg+se))+
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=avg-se, ymax=avg+se),width = .2)+ #, position = position_dodge(0.7)
scale_y_continuous(breaks = seq(200, 2400, by = 200), expand = expansion(mult = c(0, 0.05))) +
scale_fill_manual(values=c("red","black")) +            #guide=guide_legend(reverse = TRUE)
theme(axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.text=element_text(size = 10)) +
xlab("Segment Labels") +
ylab("Response Time (msecs)")+
labs(colour = "Legend", group = "Group")
ggplot(data = df_gp_SPR_CB_SegRT, aes(x = avg, y = fct_rev(s_words), fill = CONDITION, xmin=avg-se, xmax=avg+se))+
geom_bar(width = 0.7, position="dodge",stat = "identity", color = "black") +
geom_errorbar(width = 0, position = position_dodge(0.7)) +
scale_fill_grey(start = 0.4, end = 1) +
scale_x_continuous(breaks = seq(200, 2400, by = 200), expand = expansion(mult = c(0, 0.05))) +
theme_bw()+
theme(axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.text=element_text(size = 10)) +
ylab("Segment Labels") +
xlab("Response Time (msecs)") +
ggtitle("Segment RT in blind participants")
ggplot(data = df_gp_SPR_SC_SegRT, aes(x = avg, y = fct_rev(s_words), fill = CONDITION, xmin=avg-se, xmax=avg+se))+
geom_bar(width = 0.7, position="dodge",stat = "identity", color = "black") +
geom_errorbar(width = 0, position = position_dodge(0.7)) +
scale_fill_grey(start = 0.4, end = 1) +
scale_x_continuous(breaks = seq(200, 2400, by = 200), expand = expansion(mult = c(0, 0.05))) +
theme_bw()+
theme(axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.text=element_text(size = 10)) +
ylab("Segment Labels") +
xlab("Response Time (msecs)") +
ggtitle("Segment RT in sighted participants")
df_gp_SPR_CB_avg <- data.frame(
s_label <- c(1:4),
s_words <- c("average of segments 1-7", "flew", "across", "the clearing."),
CONDITION <- c(rep("GP",4),rep("NG",4)),
avg <- c(
mean(df_gp_SPR_CB_SegRT[c(1,2,3,5,6,7),]$avg),
mean(subset(gp_CB_S, Seg == 'seg07')$RT),
mean(subset(gp_CB_S, Seg == 'seg08')$RT),
mean(subset(gp_CB_S, Seg == 'seg09')$RT),
mean(df_gp_CB_SegRT[c(11,12,13,14,15,16,17),]$avg),
mean(subset(ng_CB_S, Seg == 'seg08')$RT),
mean(subset(ng_CB_S, Seg == 'seg09')$RT),
mean(subset(ng_CB_S, Seg == 'seg10')$RT)
),
se <- c(
std.error(subset(gp_CB_S, !(Seg %in% c("seg07",'seg08','seg09')))$RT),
std.error(subset(gp_CB_S, Seg == 'seg07')$RT),
std.error(subset(gp_CB_S, Seg == 'seg08')$RT),
std.error(subset(gp_CB_S, Seg == 'seg09')$RT),
std.error(subset(ng_CB_S, !(Seg %in% c("seg08",'seg09','seg10')))$RT),
std.error(subset(ng_CB_S, Seg == 'seg08')$RT),
std.error(subset(ng_CB_S, Seg == 'seg09')$RT),
std.error(subset(ng_CB_S, Seg == 'seg10')$RT)
)
)
colnames(df_gp_SPR_CB_avg)<-(c("s_label", "s_words","CONDITION","avg","se"))
df_gp_SPR_SC_avg <- data.frame(
s_label <- c(1:4),
s_words <- c("average of segments 1-7", "flew", "across", "the clearing."),
CONDITION <- c(rep("GP",4),rep("NG",4)),
avg <- c(
mean(df_gp_SPR_SC_SegRT[c(1,2,3,5,6,7),]$avg),
mean(subset(gp_SPR_SC_S, Seg == 'seg07')$RT),
mean(subset(gp_SPR_SC_S, Seg == 'seg08')$RT),
mean(subset(gp_SPR_SC_S, Seg == 'seg09')$RT),
mean(df_gp_SPR_SC_SegRT[c(11,12,13,14,15,16,17),]$avg),
mean(subset(ng_SPR_SC_S, Seg == 'seg08')$RT),
mean(subset(ng_SPR_SC_S, Seg == 'seg09')$RT),
mean(subset(ng_SPR_SC_S, Seg == 'seg10')$RT)
),
se <- c(
std.error(subset(gp_SPR_SC_S, !(Seg %in% c("seg07",'seg08','seg09')))$RT),
std.error(subset(gp_SPR_SC_S, Seg == 'seg07')$RT),
std.error(subset(gp_SPR_SC_S, Seg == 'seg08')$RT),
std.error(subset(gp_SPR_SC_S, Seg == 'seg09')$RT),
std.error(subset(ng_SPR_SC_S, !(Seg %in% c("seg08",'seg09','seg10')))$RT),
std.error(subset(ng_SPR_SC_S, Seg == 'seg08')$RT),
std.error(subset(ng_SPR_SC_S, Seg == 'seg09')$RT),
std.error(subset(ng_SPR_SC_S, Seg == 'seg10')$RT)
)
)
colnames(df_gp_SPR_SC_avg)<-(c("s_label", "s_words","CONDITION","avg","se"))
df_gp_SegRT_avg <- data.frame(rbind(df_gp_SPR_CB_avg,df_gp_SPR_SC_avg))
df_gp_SegRT_avg$Group <- c(rep("Blind",8),rep("Sighted",8))
df_gp_SPR_CB_avg$s_words <- factor(df_gp_SPR_CB_avg$s_words, levels = c("average of segments 1-7", "flew", "across", "the clearing."))
df_gp_SPR_SC_avg$s_words <- factor(df_gp_SPR_SC_avg$s_words, levels = c("average of segments 1-7", "flew", "across", "the clearing."))
df_gp_SegRT_avg$s_words <- factor(df_gp_SegRT_avg$s_words, levels = c("average of segments 1-7", "flew", "across", "the clearing."))
ggplot(data = df_gp_SPR_CB_avg, aes(x = avg, y = fct_rev(s_words), fill = CONDITION, xmin=avg-se, xmax=avg+se))+
geom_bar(width = 0.7, position="dodge",stat = "identity", color = "black") +
geom_errorbar(width = 0, position = position_dodge(0.7)) +
scale_fill_grey(start = 0.4, end = 1) +
scale_x_continuous(breaks = seq(0, 8000, by = 1000), expand = expansion(mult = c(0, 0.05))) +
theme_bw()+
theme(axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.text=element_text(size = 10)) +
ylab("Segment Labels") +
xlab("Response Time (msecs)") +
ggtitle("Segment RT in blind participants")
ggplot(data = df_gp_SPR_SC_avg, aes(x = avg, y = fct_rev(s_words), fill = CONDITION, xmin=avg-se, xmax=avg+se))+
geom_bar(width = 0.7, position="dodge",stat = "identity", color = "black") +
geom_errorbar(width = 0, position = position_dodge(0.7)) +
scale_fill_grey(start = 0.4, end = 1) +
scale_x_continuous(breaks = seq(0, 2000, by = 200), expand = expansion(mult = c(0, 0.05))) +
theme_bw()+
theme(axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.text=element_text(size = 10)) +
ylab("Segment Labels") +
xlab("Response Time (msecs)") +
ggtitle("Segment RT in sighted participants")
View(df_gp_SPR_CB_avg)
df_gp_SPR_CB_avg <- data.frame(
s_label <- c(1:4),
s_words <- c("average of segments 1-7", "flew", "across", "the clearing."),
CONDITION <- c(rep("GP",4),rep("NG",4)),
avg <- c(
mean(df_gp_SPR_CB_SegRT[c(1,2,3,5,6,7),]$avg),
mean(subset(gp_CB_S, Seg == 'seg07')$RT),
mean(subset(gp_CB_S, Seg == 'seg08')$RT),
mean(subset(gp_CB_S, Seg == 'seg09')$RT),
mean(df_gp_SPR_CB_SegRT[c(11,12,13,14,15,16,17),]$avg),
mean(subset(ng_CB_S, Seg == 'seg08')$RT),
mean(subset(ng_CB_S, Seg == 'seg09')$RT),
mean(subset(ng_CB_S, Seg == 'seg10')$RT)
),
se <- c(
std.error(subset(gp_CB_S, !(Seg %in% c("seg07",'seg08','seg09')))$RT),
std.error(subset(gp_CB_S, Seg == 'seg07')$RT),
std.error(subset(gp_CB_S, Seg == 'seg08')$RT),
std.error(subset(gp_CB_S, Seg == 'seg09')$RT),
std.error(subset(ng_CB_S, !(Seg %in% c("seg08",'seg09','seg10')))$RT),
std.error(subset(ng_CB_S, Seg == 'seg08')$RT),
std.error(subset(ng_CB_S, Seg == 'seg09')$RT),
std.error(subset(ng_CB_S, Seg == 'seg10')$RT)
)
)
colnames(df_gp_SPR_CB_avg)<-(c("s_label", "s_words","CONDITION","avg","se"))
df_gp_SPR_SC_avg <- data.frame(
s_label <- c(1:4),
s_words <- c("average of segments 1-7", "flew", "across", "the clearing."),
CONDITION <- c(rep("GP",4),rep("NG",4)),
avg <- c(
mean(df_gp_SPR_SC_SegRT[c(1,2,3,5,6,7),]$avg),
mean(subset(gp_SPR_SC_S, Seg == 'seg07')$RT),
mean(subset(gp_SPR_SC_S, Seg == 'seg08')$RT),
mean(subset(gp_SPR_SC_S, Seg == 'seg09')$RT),
mean(df_gp_SPR_SC_SegRT[c(11,12,13,14,15,16,17),]$avg),
mean(subset(ng_SPR_SC_S, Seg == 'seg08')$RT),
mean(subset(ng_SPR_SC_S, Seg == 'seg09')$RT),
mean(subset(ng_SPR_SC_S, Seg == 'seg10')$RT)
),
se <- c(
std.error(subset(gp_SPR_SC_S, !(Seg %in% c("seg07",'seg08','seg09')))$RT),
std.error(subset(gp_SPR_SC_S, Seg == 'seg07')$RT),
std.error(subset(gp_SPR_SC_S, Seg == 'seg08')$RT),
std.error(subset(gp_SPR_SC_S, Seg == 'seg09')$RT),
std.error(subset(ng_SPR_SC_S, !(Seg %in% c("seg08",'seg09','seg10')))$RT),
std.error(subset(ng_SPR_SC_S, Seg == 'seg08')$RT),
std.error(subset(ng_SPR_SC_S, Seg == 'seg09')$RT),
std.error(subset(ng_SPR_SC_S, Seg == 'seg10')$RT)
)
)
colnames(df_gp_SPR_SC_avg)<-(c("s_label", "s_words","CONDITION","avg","se"))
df_gp_SegRT_avg <- data.frame(rbind(df_gp_SPR_CB_avg,df_gp_SPR_SC_avg))
df_gp_SegRT_avg$Group <- c(rep("Blind",8),rep("Sighted",8))
df_gp_SPR_CB_avg$s_words <- factor(df_gp_SPR_CB_avg$s_words, levels = c("average of segments 1-7", "flew", "across", "the clearing."))
df_gp_SPR_SC_avg$s_words <- factor(df_gp_SPR_SC_avg$s_words, levels = c("average of segments 1-7", "flew", "across", "the clearing."))
df_gp_SegRT_avg$s_words <- factor(df_gp_SegRT_avg$s_words, levels = c("average of segments 1-7", "flew", "across", "the clearing."))
ggplot(data = df_gp_SPR_CB_avg, aes(x = avg, y = fct_rev(s_words), fill = CONDITION, xmin=avg-se, xmax=avg+se))+
geom_bar(width = 0.7, position="dodge",stat = "identity", color = "black") +
geom_errorbar(width = 0, position = position_dodge(0.7)) +
scale_fill_grey(start = 0.4, end = 1) +
scale_x_continuous(breaks = seq(0, 8000, by = 1000), expand = expansion(mult = c(0, 0.05))) +
theme_bw()+
theme(axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.text=element_text(size = 10)) +
ylab("Segment Labels") +
xlab("Response Time (msecs)") +
ggtitle("Segment RT in blind participants")
ggplot(data = df_gp_SPR_SC_avg, aes(x = avg, y = fct_rev(s_words), fill = CONDITION, xmin=avg-se, xmax=avg+se))+
geom_bar(width = 0.7, position="dodge",stat = "identity", color = "black") +
geom_errorbar(width = 0, position = position_dodge(0.7)) +
scale_fill_grey(start = 0.4, end = 1) +
scale_x_continuous(breaks = seq(0, 2000, by = 200), expand = expansion(mult = c(0, 0.05))) +
theme_bw()+
theme(axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.text=element_text(size = 10)) +
ylab("Segment Labels") +
xlab("Response Time (msecs)") +
ggtitle("Segment RT in sighted participants")
ggplot(data = df_gp_SPR_CB_avg, aes(x = avg, y = fct_rev(s_words), fill = CONDITION, xmin=avg-se, xmax=avg+se))+
geom_bar(width = 0.7, position="dodge",stat = "identity", color = "black") +
geom_errorbar(width = 0, position = position_dodge(0.7)) +
scale_fill_grey(start = 0.4, end = 1) +
scale_x_continuous(breaks = seq(0, 8000, by = 200), expand = expansion(mult = c(0, 0.05))) +
theme_bw()+
theme(axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.text=element_text(size = 10)) +
ylab("Segment Labels") +
xlab("Response Time (msecs)") +
ggtitle("Segment RT in blind participants")
ggplot(data = df_gp_SPR_SC_avg, aes(x = avg, y = fct_rev(s_words), fill = CONDITION, xmin=avg-se, xmax=avg+se))+
geom_bar(width = 0.7, position="dodge",stat = "identity", color = "black") +
geom_errorbar(width = 0, position = position_dodge(0.7)) +
scale_fill_grey(start = 0.4, end = 1) +
scale_x_continuous(breaks = seq(0, 2000, by = 200), expand = expansion(mult = c(0, 0.05))) +
theme_bw()+
theme(axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.text=element_text(size = 10)) +
ylab("Segment Labels") +
xlab("Response Time (msecs)") +
ggtitle("Segment RT in sighted participants")
ggplot(data = df_gp_SPR_SegRT, aes(x = s_words, y=avg, group = interaction(CONDITION, Group), colour = CONDITION, linetype = Group, ymin=avg-se, ymax=avg+se))+
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=avg-se, ymax=avg+se),width = .2)+ #, position = position_dodge(0.7)
scale_y_continuous(breaks = seq(200, 2400, by = 200), expand = expansion(mult = c(0, 0.05))) +
scale_fill_manual(values=c("red","black")) +            #guide=guide_legend(reverse = TRUE)
theme(axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.text=element_text(size = 10)) +
xlab("Segment Labels") +
ylab("Response Time (msecs)")+
labs(colour = "Legend", group = "Group")
knitr::opts_chunk$set(echo = TRUE)
source("./SP_filter_plot.R")
load("./FINAL_SPR_CB_filtered.RData")
load("./FINAL_SPR_SC_filtered.RData")
library(nortest)
library(janitor)
library(data.table)
library("gridExtra")
library("lme4")
library("plotrix")
#detach(package:plyr)
final_SPR_CB_Q$CONDITION <- factor(final_SPR_CB_Q$CONDITION, levels = c("GP","NG","MV","NMV","FL"))
final_SPR_CB_S$CONDITION <- factor(final_SPR_CB_S$CONDITION, levels = c("GP","NG","MV","NMV","FL"))
final_SPR_SC_Q$CONDITION <- factor(final_SPR_SC_Q$CONDITION, levels = c("GP","NG","MV","NMV","FL"))
final_SPR_SC_S$CONDITION <- factor(final_SPR_SC_S$CONDITION, levels = c("GP","NG","MV","NMV","FL"))
final_SPR_CB_Q$"RT+Duration" <- final_SPR_CB_Q$RT + final_SPR_CB_Q$Duration*1000
final_SPR_SC_Q$"RT+Duration" <- final_SPR_SC_Q$RT + final_SPR_SC_Q$Duration
cb_acc_ind <- accuracy_by_cond(final_SPR_CB_Q)
sc_acc_ind <- accuracy_by_cond(final_SPR_SC_Q)
cb_acc <- accuracy_by_cond(final_SPR_CB_Q, within_subject = FALSE)
sc_acc <- accuracy_by_cond(final_SPR_SC_Q, within_subject = FALSE)
acc_comparison <- data.frame(rbind(cb_acc, sc_acc))
acc_comparison$GROUP = c(rep('Blind',5),rep('Sighted',5))
acc_comparison <- subset(acc_comparison, CONDITION != 'FL')
ggplot(data = acc_comparison, aes(x = CONDITION, y = Accuracy, fill=GROUP,
ymin=Accuracy-se, ymax=Accuracy+se))+
geom_bar(width = 0.7, position="dodge", stat = "identity", color = "black") +
scale_fill_grey(start = 0.4, end = 1)+
theme_bw()+
scale_y_continuous(labels = scales::percent, breaks = seq(0, 1.1, by = 0.2), expand = expansion(mult = c(0, 0.05))) +
theme(axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.text=element_text(size = 10)) +
geom_errorbar(width = 0, position = position_dodge(0.7))+
xlab("Condition") +
labs(fill = "Participant Group:") +
geom_text(aes(x=CONDITION, Accuracy,label=(perc)), position=position_dodge(width=1), vjust=-0.5, size=3.8) +
ggtitle("Mean Accuracy for sighted and blind participants in each condition")
gp_cb_df <- subset(final_SPR_CB_Q[c("CONDITION", "ITEM", "ID", "Correct")], CONDITION %in% c("GP", "NG"))
gp_sc_df <- subset(final_SPR_SC_Q[c("CONDITION", "ITEM", "ID","Correct")], CONDITION %in% c("GP", "NG"))
gp_cb_df$Group = 0
gp_sc_df$Group = 1
acc_CB_q_gp <- data.frame(rbind(gp_cb_df, gp_sc_df))
filt_GPLG_glm_cb <- glmer(Correct ~ CONDITION * Group + (1|ITEM) + (1|ID),
data=acc_CB_q_gp, family=binomial(link="logit"),
control = glmerControl(optimizer = "bobyqa"))
summary(filt_GPLG_glm_cb)
gp_SPR_cb_df <- subset(final_SPR_CB_Q[c("CONDITION", "ITEM", "ID", "Correct")], CONDITION %in% c("GP", "NG"))
gp_SPR_sc_df <- subset(final_SPR_SC_Q[c("CONDITION", "ITEM", "ID","Correct")], CONDITION %in% c("GP", "NG"))
gp_SPR_cb_df$Group = 0
gp_SPR_sc_df$Group = 1
acc_SPR_CB_q_gp <- data.frame(rbind(gp_SPR_cb_df, gp_SPR_sc_df))
filt_SPR_GPLG_glm_cb <- glmer(Correct ~ CONDITION * Group + (1|ITEM) + (1|ID),
data=acc_SPR_CB_q_gp, family=binomial(link="logit"),
control = glmerControl(optimizer = "bobyqa"))
summary(filt_SPR_GPLG_glm_cb)
knitr::opts_chunk$set(echo = TRUE)
source("./SP_filter_plot.R")
load("./FINAL_SPR_CB_filtered.RData")
load("./FINAL_SPR_SC_filtered.RData")
library(nortest)
library(janitor)
library(data.table)
library("gridExtra")
library("lme4")
library("plotrix")
#detach(package:plyr)
final_SPR_CB_Q$CONDITION <- factor(final_SPR_CB_Q$CONDITION, levels = c("GP","NG","MV","NMV","FL"))
final_SPR_CB_S$CONDITION <- factor(final_SPR_CB_S$CONDITION, levels = c("GP","NG","MV","NMV","FL"))
final_SPR_SC_Q$CONDITION <- factor(final_SPR_SC_Q$CONDITION, levels = c("GP","NG","MV","NMV","FL"))
final_SPR_SC_S$CONDITION <- factor(final_SPR_SC_S$CONDITION, levels = c("GP","NG","MV","NMV","FL"))
final_SPR_CB_Q$"RT+Duration" <- final_SPR_CB_Q$RT + final_SPR_CB_Q$Duration*1000
final_SPR_SC_Q$"RT+Duration" <- final_SPR_SC_Q$RT + final_SPR_SC_Q$Duration
cb_acc_ind <- accuracy_by_cond(final_SPR_CB_Q)
sc_acc_ind <- accuracy_by_cond(final_SPR_SC_Q)
cb_acc <- accuracy_by_cond(final_SPR_CB_Q, within_subject = FALSE)
sc_acc <- accuracy_by_cond(final_SPR_SC_Q, within_subject = FALSE)
acc_comparison <- data.frame(rbind(cb_acc, sc_acc))
acc_comparison$GROUP = c(rep('Blind',5),rep('Sighted',5))
acc_comparison <- subset(acc_comparison, CONDITION != 'FL')
ggplot(data = acc_comparison, aes(x = CONDITION, y = Accuracy, fill=GROUP,
ymin=Accuracy-se, ymax=Accuracy+se))+
geom_bar(width = 0.7, position="dodge", stat = "identity", color = "black") +
scale_fill_grey(start = 0.4, end = 1)+
theme_bw()+
scale_y_continuous(labels = scales::percent, breaks = seq(0, 1.1, by = 0.2), expand = expansion(mult = c(0, 0.05))) +
theme(axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.text=element_text(size = 10)) +
geom_errorbar(width = 0, position = position_dodge(0.7))+
xlab("Condition") +
labs(fill = "Participant Group:") +
geom_text(aes(x=CONDITION, Accuracy,label=(perc)), position=position_dodge(width=1), vjust=-0.5, size=3.8) +
ggtitle("Mean Accuracy for sighted and blind participants in each condition")
gp_SPR_cb_df <- subset(final_SPR_CB_Q[c("CONDITION", "ITEM", "ID", "Correct")], CONDITION %in% c("GP", "NG"))
gp_SPR_sc_df <- subset(final_SPR_SC_Q[c("CONDITION", "ITEM", "ID","Correct")], CONDITION %in% c("GP", "NG"))
gp_SPR_cb_df$Group = 0
gp_SPR_sc_df$Group = 1
acc_SPR_CB_q_gp <- data.frame(rbind(gp_SPR_cb_df, gp_SPR_sc_df))
filt_SPR_GPLG_glm_cb <- glmer(Correct ~ CONDITION * Group + (1|ITEM) + (1|ID),
data=acc_SPR_CB_q_gp, family=binomial(link="logit"),
control = glmerControl(optimizer = "bobyqa"))
summary(filt_SPR_GPLG_glm_cb)
filt_GP_glm_CBonly <- glmer(Correct ~ CONDITION + (1|ITEM) + (1|ID),
data=gp_cb_df, family=binomial(link="logit"),
control = glmerControl(optimizer = "bobyqa"))
summary(filt_GP_glm_CBonly)
filt_GP_glm_SConly <- glmer(Correct ~ CONDITION + (1|ITEM) + (1|ID),
data=gp_sc_df, family=binomial(link="logit"),
control = glmerControl(optimizer = "bobyqa"))
summary(filt_GP_glm_SConly)
filt_GP_glm_SConly <- glmer(Correct ~ CONDITION + (1|ITEM) + (1|ID),
data=gp_sc_df, family=binomial(link="logit"),
control = glmerControl(optimizer = "bobyqa"))
summary(filt_GP_glm_SConly)
df_gp_SPR_CB_avg <- data.frame(
s_label <- c(1:4),
s_words <- c("average of segments 1-7", "flew", "across", "the clearing."),
CONDITION <- c(rep("GP",4),rep("NG",4)),
avg <- c(
mean(df_gp_SPR_CB_SegRT[c(1,2,3,5,6,7),]$avg),
mean(subset(gp_CB_S, Seg == 'seg07')$RT),
mean(subset(gp_CB_S, Seg == 'seg08')$RT),
mean(subset(gp_CB_S, Seg == 'seg09')$RT),
mean(df_gp_SPR_CB_SegRT[c(11,12,13,14,15,16,17),]$avg),
mean(subset(ng_CB_S, Seg == 'seg08')$RT),
mean(subset(ng_CB_S, Seg == 'seg09')$RT),
mean(subset(ng_CB_S, Seg == 'seg10')$RT)
),
se <- c(
std.error(subset(gp_CB_S, !(Seg %in% c("seg07",'seg08','seg09')))$RT),
std.error(subset(gp_CB_S, Seg == 'seg07')$RT),
std.error(subset(gp_CB_S, Seg == 'seg08')$RT),
std.error(subset(gp_CB_S, Seg == 'seg09')$RT),
std.error(subset(ng_CB_S, !(Seg %in% c("seg08",'seg09','seg10')))$RT),
std.error(subset(ng_CB_S, Seg == 'seg08')$RT),
std.error(subset(ng_CB_S, Seg == 'seg09')$RT),
std.error(subset(ng_CB_S, Seg == 'seg10')$RT)
)
)
colnames(df_gp_SPR_CB_avg)<-(c("s_label", "s_words","CONDITION","avg","se"))
df_gp_SPR_SC_avg <- data.frame(
s_label <- c(1:4),
s_words <- c("average of segments 1-7", "flew", "across", "the clearing."),
CONDITION <- c(rep("GP",4),rep("NG",4)),
avg <- c(
mean(df_gp_SPR_SC_SegRT[c(1,2,3,5,6,7),]$avg),
mean(subset(gp_SPR_SC_S, Seg == 'seg07')$RT),
mean(subset(gp_SPR_SC_S, Seg == 'seg08')$RT),
mean(subset(gp_SPR_SC_S, Seg == 'seg09')$RT),
mean(df_gp_SPR_SC_SegRT[c(11,12,13,14,15,16,17),]$avg),
mean(subset(ng_SPR_SC_S, Seg == 'seg08')$RT),
mean(subset(ng_SPR_SC_S, Seg == 'seg09')$RT),
mean(subset(ng_SPR_SC_S, Seg == 'seg10')$RT)
),
se <- c(
std.error(subset(gp_SPR_SC_S, !(Seg %in% c("seg07",'seg08','seg09')))$RT),
std.error(subset(gp_SPR_SC_S, Seg == 'seg07')$RT),
std.error(subset(gp_SPR_SC_S, Seg == 'seg08')$RT),
std.error(subset(gp_SPR_SC_S, Seg == 'seg09')$RT),
std.error(subset(ng_SPR_SC_S, !(Seg %in% c("seg08",'seg09','seg10')))$RT),
std.error(subset(ng_SPR_SC_S, Seg == 'seg08')$RT),
std.error(subset(ng_SPR_SC_S, Seg == 'seg09')$RT),
std.error(subset(ng_SPR_SC_S, Seg == 'seg10')$RT)
)
)
colnames(df_gp_SPR_SC_avg)<-(c("s_label", "s_words","CONDITION","avg","se"))
df_gp_SegRT_avg <- data.frame(rbind(df_gp_SPR_CB_avg,df_gp_SPR_SC_avg))
df_gp_SegRT_avg$Group <- c(rep("Blind",8),rep("Sighted",8))
df_gp_SPR_CB_avg$s_words <- factor(df_gp_SPR_CB_avg$s_words, levels = c("average of segments 1-7", "flew", "across", "the clearing."))
df_gp_SPR_SC_avg$s_words <- factor(df_gp_SPR_SC_avg$s_words, levels = c("average of segments 1-7", "flew", "across", "the clearing."))
df_gp_SegRT_avg$s_words <- factor(df_gp_SegRT_avg$s_words, levels = c("average of segments 1-7", "flew", "across", "the clearing."))
ggplot(data = df_gp_SPR_CB_avg, aes(x = avg, y = fct_rev(s_words), fill = CONDITION, xmin=avg-se, xmax=avg+se))+
geom_bar(width = 0.7, position="dodge",stat = "identity", color = "black") +
geom_errorbar(width = 0, position = position_dodge(0.7)) +
scale_fill_grey(start = 0.4, end = 1) +
scale_x_continuous(breaks = seq(0, 8000, by = 200), expand = expansion(mult = c(0, 0.05))) +
theme_bw()+
theme(axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.text=element_text(size = 10)) +
ylab("Segment Labels") +
xlab("Response Time (msecs)") +
ggtitle("Segment RT in blind participants")
ggplot(data = df_gp_SPR_SC_avg, aes(x = avg, y = fct_rev(s_words), fill = CONDITION, xmin=avg-se, xmax=avg+se))+
geom_bar(width = 0.7, position="dodge",stat = "identity", color = "black") +
geom_errorbar(width = 0, position = position_dodge(0.7)) +
scale_fill_grey(start = 0.4, end = 1) +
scale_x_continuous(breaks = seq(0, 2000, by = 200), expand = expansion(mult = c(0, 0.05))) +
theme_bw()+
theme(axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.text=element_text(size = 10)) +
ylab("Segment Labels") +
xlab("Response Time (msecs)") +
ggtitle("Segment RT in sighted participants")
